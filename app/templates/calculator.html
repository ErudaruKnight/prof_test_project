<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <title>Калькулятор ЕГЭ</title>
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
  <link rel="stylesheet" href="{{ url_for('static', filename='styles.css') }}">
</head>
<body>
<nav class="navbar navbar-expand-lg navbar-dark bg-dark">
  <a class="navbar-brand" href="{{ url_for('main.index') }}">ProfTest</a>
  {% if current_user.is_authenticated %}
  <ul class="navbar-nav ml-auto">
    <li class="nav-item"><a class="nav-link" href="{{ url_for('calc.ege_calculator') }}">Калькулятор ЕГЭ</a></li>
    <li class="nav-item"><a class="nav-link" href="{{ url_for('main.profile') }}">Профиль</a></li>
    <li class="nav-item"><a class="nav-link" href="{{ url_for('auth.logout') }}">Выйти</a></li>
  </ul>
  {% endif %}
</nav>

<div class="container-fluid mt-4">
  <h2>Калькулятор ЕГЭ</h2>
  <form method="post" class="mb-4">
    <div class="form-row">
      <div class="form-group col">
        <label for="ege_math">Математика</label>
        <input type="number" class="form-control" id="ege_math" name="ege_math" value="{{ scores.math }}" min="0" max="100">
      </div>
      <div class="form-group col">
        <label for="ege_russian">Русский язык</label>
        <input type="number" class="form-control" id="ege_russian" name="ege_russian" value="{{ scores.russian }}" min="0" max="100">
      </div>
      <div class="form-group col">
        <label for="ege_physics">Физика</label>
        <input type="number" class="form-control" id="ege_physics" name="ege_physics" value="{{ scores.physics }}" min="0" max="100">
      </div>
    </div>
    <div class="form-row">
      <div class="form-group col">
        <label for="ege_informatics">Информатика</label>
        <input type="number" class="form-control" id="ege_informatics" name="ege_informatics" value="{{ scores.informatics }}" min="0" max="100">
      </div>
      <div class="form-group col">
        <label for="ege_chemistry">Химия</label>
        <input type="number" class="form-control" id="ege_chemistry" name="ege_chemistry" value="{{ scores.chemistry }}" min="0" max="100">
      </div>
      <div class="form-group col">
        <label for="ege_social">Обществознание</label>
        <input type="number" class="form-control" id="ege_social" name="ege_social" value="{{ scores.social }}" min="0" max="100">
      </div>
      <div class="form-group col">
        <label for="ege_language">Иностранный язык</label>
        <input type="number" class="form-control" id="ege_language" name="ege_language" value="{{ scores.language }}" min="0" max="100">
      </div>
    </div>
    <button type="submit" class="btn btn-primary">Рассчитать</button>
  </form>

  <div class="table-responsive">
    <table class="table table-bordered table-hover table-sm w-100">
      <thead>
        <tr>
          <th>Код</th>
          <th>Направление</th>
          <th>Предметы</th>
          <th>Проходной балл 2024</th>
          <th>Ваш балл</th>
          <th>Шанс</th>
          <th>Бюджетных мест</th>
          <th>Стоимость</th>
          <th>Платные места (РФ)</th>
          <th>Платные места (иност.)</th>
        </tr>
      </thead>
      <tbody>
        {% for p in programs %}
        <tr {% if p.eligible %}class="table-success"{% endif %}>
          <td>{{ p.code }}</td>
          <td>{{ p.name }}</td>
          <td>{{ p.subjects_full }}</td>
          <td>{{ p.score_2024 or '—' }}</td>
          <td>{{ p.user_score }}</td>
          <td>
            {% if p.probability is not none %}
              <div class="progress">
                <div class="progress-bar {{ p.prob_color }}" role="progressbar" style="width: {{ p.probability }}%">
                  {{ p.probability }}%
                </div>
              </div>
            {% else %}—{% endif %}
          </td>
          <td>{{ p.budget_total or '—' }}</td>
          <td>{{ p.cost_display }}</td>
          <td>{{ p.paid_ru or '—' }}</td>
          <td>{{ p.paid_int or '—' }}</td>
        </tr>
        {% endfor %}
      </tbody>
    </table>
  </div>
</div>
</body>
</html>
